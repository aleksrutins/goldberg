amends "./pkl/Config.pkl"
import "./pkl/presets/Files.pkl"
import "./pkl/presets/Forester.pkl"
import "./pkl/presets/Maven.pkl"
import "./pkl/presets/Pkldoc.pkl"
import "./pkl/release/SourceHut.pkl"

name = "goldberg"
version = "0.3.0"

use {
  Pkldoc.build("pkl", "docs/output/docs")
  Forester.build("docs/forest.toml")
  Files.copy("pkl", "docs/output")
  SourceHut.deployPages("docs/output", "goldberg.farthergate.com")

  Maven.package(true)
  module.single(
    module.command(new Listing { "bash"; "make-executable-jar.sh"; module.versionedName }),
  )
  SourceHut.release(
    source,
    new Listing { module.versionedName },
    "v" + version,
  )
}

source {
  repo = "goldberg"
}
