amends "./pkl/Config.pkl"
import "./pkl/presets/Files.pkl"
import "./pkl/presets/Forester.pkl"
import "./pkl/presets/Maven.pkl"
import "./pkl/presets/Pkldoc.pkl"
import "./pkl/release/SourceHut.pkl"

name = "goldberg"
version = "0.2.2"

use {
  Pkldoc.build("pkl", "docs/output/docs")
  Forester.build("docs/forest.toml")
  Files.copy("pkl", "docs/output")
  SourceHut.deployPages("docs/output", "goldberg.farthergate.com")

  Maven.package(true)
  Files.copyMap(new Mapping { ["goldberg"] = module.versionedName })
  SourceHut.release(
    source,
    new Listing { module.versionedName },
    "v" + version,
  )
}

source {
  repo = "goldberg"
}
